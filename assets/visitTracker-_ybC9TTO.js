import{a as s}from"./index-Bq31S5oz.js";class r{constructor(){this.isTracking=!1,this.sessionId=this.generateSessionId(),this.lastTrackTime=0,this.trackingInterval=3e4}generateSessionId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}async trackPageVisit(i,a={}){try{const t=Date.now();if(t-this.lastTrackTime<this.trackingInterval)return;const e={page:i||window.location.pathname,userAgent:navigator.userAgent,referrer:document.referrer,sessionId:this.sessionId,timestamp:new Date().toISOString(),...a};s.trackVisit(e).catch(()=>{}),this.lastTrackTime=t}catch{}}startAutoTracking(i){this.isTracking||(this.isTracking=!0,this.trackPageVisit(window.location.pathname),i.afterEach(a=>{this.trackPageVisit(a.path)}),document.addEventListener("visibilitychange",()=>{document.hidden||this.trackPageVisit(window.location.pathname,{type:"visibility_change"})}))}stopAutoTracking(){this.isTracking=!1}async trackEvent(i,a={}){try{const t={page:window.location.pathname,event:i,data:a,sessionId:this.sessionId,timestamp:new Date().toISOString()};s.trackVisit(t).catch(()=>{})}catch{}}}const o=new r;export{o as visitTracker};
