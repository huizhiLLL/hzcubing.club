import{a as s}from"./index-CK2GeIUh.js";class n{constructor(){this.isTracking=!1,this.sessionId=this.generateSessionId(),this.lastTrackTime=0,this.trackingInterval=3e4}generateSessionId(){return Date.now().toString(36)+Math.random().toString(36).substr(2)}async trackPageVisit(i,a={}){try{const t=i||window.location.pathname;if(t!=="/"&&t!=="/home")return;const e=Date.now();if(e-this.lastTrackTime<this.trackingInterval)return;const r={page:t,userAgent:navigator.userAgent,referrer:document.referrer,sessionId:this.sessionId,timestamp:new Date().toISOString(),...a};s.trackVisit(r).catch(()=>{}),this.lastTrackTime=e}catch{}}startAutoTracking(i){this.isTracking||(this.isTracking=!0,this.trackPageVisit(window.location.pathname),i.afterEach(a=>{this.trackPageVisit(a.path)}),document.addEventListener("visibilitychange",()=>{document.hidden||this.trackPageVisit(window.location.pathname,{type:"visibility_change"})}))}stopAutoTracking(){this.isTracking=!1}async trackEvent(i,a={}){try{const t={page:window.location.pathname,event:i,data:a,sessionId:this.sessionId,timestamp:new Date().toISOString()};s.trackVisit(t).catch(()=>{})}catch{}}}const h=new n;export{h as visitTracker};
