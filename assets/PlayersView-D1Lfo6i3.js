import{_ as T,h as W,r as u,c as b,o as j,a as M,E as w,j as r,k as U,l as p,m as h,n,p as o,q as y,y as O,z as q,x as k,t as m,v as x,s as F,T as Q}from"./index-Bq31S5oz.js";import{E as z}from"./ElementTransition-DUTP6Xtl.js";const R={class:"players-container"},Y={class:"card-header"},G={key:0,class:"wca-id"},H={key:0,class:"pagination-container"},J={__name:"PlayersView",setup(K){W();const l=u([]),d=u(!0),_=u(""),c=u(1),i=u(10),C=b(()=>_.value?l.value.filter(e=>e.nickname&&e.nickname.toLowerCase().includes(_.value.toLowerCase())):l.value),P=b(()=>{const e=(c.value-1)*i.value,a=e+i.value;return C.value.slice(e,a)}),V=e=>{if(!e)return"未知";try{const a=new Date(e.$date||e),s=a.getFullYear(),f=String(a.getMonth()+1).padStart(2,"0"),v=String(a.getDate()).padStart(2,"0");return`${s}.${f}.${v}`}catch{return"日期格式错误"}},D=e=>{i.value=e,c.value=1},I=e=>{c.value=e},A=async()=>{d.value=!0;try{const e=await M.getPlayers();e.code===0?l.value=e.data||[]:e.data?(l.value=Array.isArray(e.data)?e.data:[],Array.isArray(e.data)||(console.warn("API返回的数据格式不符合预期:",e),w.warning("选手数据格式异常，请联系管理员"))):w.error(e.message||"获取选手列表失败")}catch(e){console.error("获取选手列表出错:",e),w.error("网络错误，请稍后再试")}finally{d.value=!1}},S=e=>{if(!e)return!1;const a=Object.keys(e);for(const s of a)if(s.toLowerCase()==="wcaid"&&e[s])return!0;return!!(e.wcaId||e.wca_id||e.wcaid||e.WCAID)},B=e=>{if(!e)return"";const a=Object.keys(e);for(const s of a)if(s.toLowerCase()==="wcaid"&&e[s])return e[s];return e.wcaId||e.wca_id||e.wcaid||e.WCAID||""};return j(()=>{A()}),(e,a)=>{const s=r("el-icon"),f=r("el-input"),v=r("router-link"),g=r("el-table-column"),E=r("el-table"),$=r("el-pagination"),L=r("el-card"),N=U("loading");return p(),h("div",R,[n(z,{name:"fade",duration:600,appear:""},{default:o(()=>a[3]||(a[3]=[y("h1",{class:"page-title glass-header"},"选手列表",-1)])),_:1}),n(z,{name:"slide-up",duration:600,delay:200,appear:""},{default:o(()=>[n(L,{class:"players-card glass-card"},{header:o(()=>[y("div",Y,[a[4]||(a[4]=y("h2",null,"所有选手",-1)),n(f,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=t=>_.value=t),placeholder:"搜索选手昵称",clearable:"",class:"search-input"},{prefix:o(()=>[n(s,null,{default:o(()=>[n(F(Q))]),_:1})]),_:1},8,["modelValue"])])]),default:o(()=>[O((p(),q(E,{data:P.value,style:{width:"100%"},"empty-text":d.value?"加载中...":"暂无选手数据",class:"glass-table"},{default:o(()=>[n(g,{prop:"nickname",label:"昵称","min-width":"120"},{default:o(t=>[n(v,{to:`/user/${t.row._id||t.row.id}`,class:"player-name-link"},{default:o(()=>[k(m(t.row.nickname)+" ",1),S(t.row)?(p(),h("span",G,"("+m(B(t.row))+")",1)):x("",!0)]),_:2},1032,["to"])]),_:1}),n(g,{prop:"bio",label:"签名","min-width":"200"},{default:o(t=>[k(m(t.row.bio||""),1)]),_:1}),n(g,{label:"注册时间","min-width":"120"},{default:o(t=>[k(m(V(t.row.createTime)),1)]),_:1})]),_:1},8,["data","empty-text"])),[[N,d.value]]),l.value.length>0?(p(),h("div",H,[n($,{"current-page":c.value,"onUpdate:currentPage":a[1]||(a[1]=t=>c.value=t),"page-size":i.value,"onUpdate:pageSize":a[2]||(a[2]=t=>i.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",total:C.value.length,onSizeChange:D,onCurrentChange:I},null,8,["current-page","page-size","total"])])):x("",!0)]),_:1})]),_:1})])}}},ee=T(J,[["__scopeId","data-v-0cb29f68"]]);export{ee as default};
