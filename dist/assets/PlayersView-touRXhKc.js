import{_ as N,h as W,r as u,c as C,o as M,E as w,j as r,k as T,l as p,m as h,n,p as o,q as y,y as U,z as O,x as k,t as f,v as x,s as q,S as F}from"./index-PkMhL9Jo.js";import{E as z}from"./ElementTransition-CBiVA3Qv.js";const Q={class:"players-container"},R={class:"card-header"},Y={key:0,class:"wca-id"},G={key:0,class:"pagination-container"},H={__name:"PlayersView",setup(J){W();const l=u([]),d=u(!0),_=u(""),c=u(1),i=u(10),b=C(()=>_.value?l.value.filter(e=>e.nickname&&e.nickname.toLowerCase().includes(_.value.toLowerCase())):l.value),V=C(()=>{const e=(c.value-1)*i.value,a=e+i.value;return b.value.slice(e,a)}),D=e=>{if(!e)return"未知";try{const a=new Date(e.$date||e),s=a.getFullYear(),m=String(a.getMonth()+1).padStart(2,"0"),v=String(a.getDate()).padStart(2,"0");return`${s}.${m}.${v}`}catch{return"日期格式错误"}},I=e=>{i.value=e,c.value=1},P=e=>{c.value=e},S=async()=>{d.value=!0;try{const a=await(await fetch("https://w3mavh11ex.bja.sealos.run/get-players")).json();a.code===0?l.value=a.data||[]:a.data?(l.value=Array.isArray(a.data)?a.data:[],Array.isArray(a.data)||(console.warn("API返回的数据格式不符合预期:",a),w.warning("选手数据格式异常，请联系管理员"))):w.error(a.message||"获取选手列表失败")}catch(e){console.error("获取选手列表出错:",e),w.error("网络错误，请稍后再试")}finally{d.value=!1}},A=e=>{if(!e)return!1;const a=Object.keys(e);for(const s of a)if(s.toLowerCase()==="wcaid"&&e[s])return!0;return!!(e.wcaId||e.wca_id||e.wcaid||e.WCAID)},j=e=>{if(!e)return"";const a=Object.keys(e);for(const s of a)if(s.toLowerCase()==="wcaid"&&e[s])return e[s];return e.wcaId||e.wca_id||e.wcaid||e.WCAID||""};return M(()=>{S()}),(e,a)=>{const s=r("el-icon"),m=r("el-input"),v=r("router-link"),g=r("el-table-column"),B=r("el-table"),E=r("el-pagination"),$=r("el-card"),L=T("loading");return p(),h("div",Q,[n(z,{name:"fade",duration:600,appear:""},{default:o(()=>a[3]||(a[3]=[y("h1",{class:"page-title glass-header"},"选手列表",-1)])),_:1}),n(z,{name:"slide-up",duration:600,delay:200,appear:""},{default:o(()=>[n($,{class:"players-card glass-card"},{header:o(()=>[y("div",R,[a[4]||(a[4]=y("h2",null,"所有选手",-1)),n(m,{modelValue:_.value,"onUpdate:modelValue":a[0]||(a[0]=t=>_.value=t),placeholder:"搜索选手昵称",clearable:"",class:"search-input"},{prefix:o(()=>[n(s,null,{default:o(()=>[n(q(F))]),_:1})]),_:1},8,["modelValue"])])]),default:o(()=>[U((p(),O(B,{data:V.value,style:{width:"100%"},"empty-text":d.value?"加载中...":"暂无选手数据",class:"glass-table"},{default:o(()=>[n(g,{prop:"nickname",label:"昵称","min-width":"120"},{default:o(t=>[n(v,{to:`/user/${t.row._id||t.row.id}`,class:"player-name-link"},{default:o(()=>[k(f(t.row.nickname)+" ",1),A(t.row)?(p(),h("span",Y,"("+f(j(t.row))+")",1)):x("",!0)]),_:2},1032,["to"])]),_:1}),n(g,{prop:"bio",label:"签名","min-width":"200"},{default:o(t=>[k(f(t.row.bio||""),1)]),_:1}),n(g,{label:"注册时间","min-width":"120"},{default:o(t=>[k(f(D(t.row.createTime)),1)]),_:1})]),_:1},8,["data","empty-text"])),[[L,d.value]]),l.value.length>0?(p(),h("div",G,[n(E,{"current-page":c.value,"onUpdate:currentPage":a[1]||(a[1]=t=>c.value=t),"page-size":i.value,"onUpdate:pageSize":a[2]||(a[2]=t=>i.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",total:b.value.length,onSizeChange:I,onCurrentChange:P},null,8,["current-page","page-size","total"])])):x("",!0)]),_:1})]),_:1})])}}},Z=N(H,[["__scopeId","data-v-bbff51b7"]]);export{Z as default};
