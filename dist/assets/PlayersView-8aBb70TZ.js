import{_ as L,k as T,r as u,m as w,o as $,E as v,b as s,p as I,c as f,d as y,e as n,f as l,g,q as M,s as q,j as _,t as h,i as H,h as Q,H as R}from"./index-Dk6zR9k4.js";import{E as b}from"./ElementTransition-B1nF07HC.js";const F={class:"players-container"},G={class:"card-header"},J={key:0,class:"pagination-container"},K="https://cube.elemecdn.com/3/7c/3ea6beec64369c2642b92c6726f1epng.png",O={__name:"PlayersView",setup(W){const C=T(),o=u([]),d=u(!0),p=u(""),r=u(1),i=u(10),m=w(()=>p.value?o.value.filter(a=>a.nickname&&a.nickname.toLowerCase().includes(p.value.toLowerCase())):o.value);w(()=>{const a=(r.value-1)*i.value,e=a+i.value;return m.value.slice(a,e)});const k=a=>{if(!a)return"未知";try{return new Date(a.$date||a).toLocaleDateString("zh-CN")}catch{return"日期格式错误"}},z=a=>{C.push(`/user/${a._id||a.id}`)},x=a=>{i.value=a,r.value=1},V=a=>{r.value=a},P=async()=>{d.value=!0;try{const e=await(await fetch("https://w3mavh11ex.bja.sealos.run/get-players")).json();e.code===0?o.value=e.data||[]:e.data?(o.value=Array.isArray(e.data)?e.data:[],Array.isArray(e.data)||(console.warn("API返回的数据格式不符合预期:",e),v.warning("选手数据格式异常，请联系管理员"))):v.error(e.message||"获取选手列表失败")}catch(a){console.error("获取选手列表出错:",a),v.error("网络错误，请稍后再试")}finally{d.value=!1}};return $(()=>{P()}),(a,e)=>{const D=s("el-icon"),A=s("el-input"),E=s("el-avatar"),c=s("el-table-column"),N=s("el-button"),B=s("el-table"),S=s("el-pagination"),U=s("el-card"),j=I("loading");return f(),y("div",F,[n(b,{name:"fade",duration:600,appear:""},{default:l(()=>e[3]||(e[3]=[g("h1",{class:"page-title glass-header"},"选手列表",-1)])),_:1}),n(b,{name:"slide-up",duration:600,delay:200,appear:""},{default:l(()=>[n(U,{class:"players-card glass-card"},{header:l(()=>[g("div",G,[e[4]||(e[4]=g("h2",null,"所有选手",-1)),n(A,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),placeholder:"搜索选手昵称",clearable:"",class:"search-input"},{prefix:l(()=>[n(D,null,{default:l(()=>[n(Q(R))]),_:1})]),_:1},8,["modelValue"])])]),default:l(()=>[M((f(),q(B,{data:m.value,style:{width:"100%"},"empty-text":d.value?"加载中...":"暂无选手数据",class:"glass-table"},{default:l(()=>[n(c,{label:"头像",width:"80"},{default:l(t=>[n(E,{size:50,src:t.row.avatar||K},{default:l(()=>[_(h(t.row.nickname?t.row.nickname.substring(0,1):"U"),1)]),_:2},1032,["src"])]),_:1}),n(c,{prop:"nickname",label:"昵称","min-width":"120"}),n(c,{prop:"bio",label:"简介","min-width":"200"},{default:l(t=>[_(h(t.row.bio||"这个选手很神秘，没有留下简介"),1)]),_:1}),n(c,{label:"注册时间","min-width":"120"},{default:l(t=>[_(h(k(t.row.createTime)),1)]),_:1}),n(c,{label:"操作",width:"120"},{default:l(t=>[n(N,{type:"primary",size:"small",onClick:X=>z(t.row)},{default:l(()=>e[5]||(e[5]=[_(" 查看详情 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data","empty-text"])),[[j,d.value]]),o.value.length>0?(f(),y("div",J,[n(S,{"current-page":r.value,"onUpdate:currentPage":e[1]||(e[1]=t=>r.value=t),"page-size":i.value,"onUpdate:pageSize":e[2]||(e[2]=t=>i.value=t),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",total:m.value.length,onSizeChange:x,onCurrentChange:V},null,8,["current-page","page-size","total"])])):H("",!0)]),_:1})]),_:1})])}}},ee=L(O,[["__scopeId","data-v-1a3d90d1"]]);export{ee as default};
